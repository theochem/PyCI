
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>PyCI Quickstart &#8212; Ayers Lab</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/pyci_tutorial';</script>
    <link rel="icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="FanCI Quickstart" href="fanci_tutorial.html" />
    <link rel="prev" title="Installation" href="../install.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Ayers Lab - Home"/>
    <img src="../_static/logo.png" class="logo__image only-dark pst-js-only" alt="Ayers Lab - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to PyCI Documentation!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">User Documentation</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">PyCI Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="fanci_tutorial.html">FanCI Quickstart</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../api/api.html">API Documentation</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/QuantumElephant/PyCI/blob/master/website/examples/pyci_tutorial.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/QuantumElephant/PyCI" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/QuantumElephant/PyCI/issues/new?title=Issue%20on%20page%20%2Fexamples/pyci_tutorial.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/examples/pyci_tutorial.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>PyCI Quickstart</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#supported-ci-methods">Supported CI methods</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-data-and-defining-the-hamiltonian">Loading data and defining the Hamiltonian</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-reference-hatree-fock-energy">Computing reference (Hatree-Fock) energy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#full-ci">Full CI</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cisd">CISD</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#seniority-truncated-ci">Seniority-truncated CI</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#griebel-knapeck-ci-gkci">Griebel-Knapeck CI (GKCI)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#heat-bath-ci">Heat Bath CI</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overlap">Overlap</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-reduced-density-matrices">Computing reduced density matrices</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="pyci-quickstart">
<h1>PyCI Quickstart<a class="headerlink" href="#pyci-quickstart" title="Link to this heading">#</a></h1>
<p>PyCI is a flexible quantum chemistry Configuration Interaction library for Python 3. The main objective of PyCI is to provide a simple and flexible framework to implement and test new CI methods. PyCI is not intended to be a high performance library, but rather a tool to test new ideas and methods.</p>
<section id="supported-ci-methods">
<h2>Supported CI methods<a class="headerlink" href="#supported-ci-methods" title="Link to this heading">#</a></h2>
<p>Through its main classes, <a class="reference internal" href="#www.github.com/PyCI/PyCI"><span class="xref myst">PyCI</span></a> supports the pair-occupied spatial orbital <a class="reference external" href="http://pyci.qcdevs.org/api/api.html#pyci.doci_wfn"><code class="docutils literal notranslate"><span class="pre">doci_wfn</span></code></a>, orthogonal spin-orbital <a class="reference external" href="http://pyci.qcdevs.org/api/api.html#pyci.fullci_wfn"><code class="docutils literal notranslate"><span class="pre">fullci_wfn</span></code></a>, and generalized orbital <a class="reference external" href="http://pyci.qcdevs.org/api/api.html#pyci.genci_wfn"><code class="docutils literal notranslate"><span class="pre">genci_wfn</span></code></a> wavefunction symmetries. The package also supports the use of the restricted and generalized Hamiltonians (unrestricted Hamiltonians can be constructed as a special case of generalized Hamiltonian). These features, combined with routines to control the type of configurations added, according to their excitation level or seniority, allows the user to easily program any CI method.</p>
<p>In the following tutorial we will look at the following wavefunction models using <strong>Be</strong> as our toy model:</p>
<ul class="simple">
<li><p>Full CI</p></li>
<li><p>CISD</p></li>
<li><p>GKCI</p></li>
<li><p>HCI</p></li>
<li><p>Seniority-truncated CI</p></li>
</ul>
<section id="loading-data-and-defining-the-hamiltonian">
<h3>Loading data and defining the Hamiltonian<a class="headerlink" href="#loading-data-and-defining-the-hamiltonian" title="Link to this heading">#</a></h3>
<p>First, we need to load the integrals data from a quantum chemistry package. PyCI supports the use of files in the <a class="reference external" href="https://doi.org/10.1016/0010-4655(89)90033-7">FCIDUMP</a> file format. The following code shows how to load the integrals from a FCIDUMP file and define the <a class="reference external" href="http://pyci.qcdevs.org/api/api.html#pyci.secondquant_op"><code class="docutils literal notranslate"><span class="pre">hamiltonian</span></code></a> object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyci</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pyci.test</span> <span class="kn">import</span> <span class="n">datafile</span>  <span class="c1"># optional, data file location for tests</span>

<span class="c1"># load system information</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">datafile</span><span class="p">(</span><span class="s2">&quot;be_ccpvdz.fcidump&quot;</span><span class="p">)</span>
<span class="n">occs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>                        <span class="c1"># (alpha, beta) occupation numbers</span>
<span class="n">ham</span> <span class="o">=</span> <span class="n">pyci</span><span class="o">.</span><span class="n">hamiltonian</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>    <span class="c1"># initialize second-quantized operator instance</span>
<span class="n">e_dict</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="computing-reference-hatree-fock-energy">
<h3>Computing reference (Hatree-Fock) energy<a class="headerlink" href="#computing-reference-hatree-fock-energy" title="Link to this heading">#</a></h3>
<p>The following code shows how to compute the reference (Hartree-Fock) energy using the PyCI package.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># contruct empty fci wave function class instance from # of basis functions and occupation</span>
<span class="n">wfn0</span> <span class="o">=</span> <span class="n">pyci</span><span class="o">.</span><span class="n">fullci_wfn</span><span class="p">(</span><span class="n">ham</span><span class="o">.</span><span class="n">nbasis</span><span class="p">,</span> <span class="o">*</span><span class="n">occs</span><span class="p">)</span>
<span class="n">wfn0</span><span class="o">.</span><span class="n">add_hartreefock_det</span><span class="p">()</span>        <span class="c1"># add Hartree-Fock determinant to wave function</span>

<span class="c1"># initialize sparse matrix operator (hamiltonian into wave function)</span>
<span class="n">op</span> <span class="o">=</span> <span class="n">pyci</span><span class="o">.</span><span class="n">sparse_op</span><span class="p">(</span><span class="n">ham</span><span class="p">,</span> <span class="n">wfn0</span><span class="p">)</span>

<span class="c1"># solve for the lowest eigenvalue and eigenvector</span>
<span class="n">e_vals</span><span class="p">,</span> <span class="n">e_vecs0</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1.0e-9</span><span class="p">)</span>
<span class="n">e_dict</span><span class="p">[</span><span class="s2">&quot;HF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wfn0</span><span class="p">),</span> <span class="n">e_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ground state wave function: HF&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of determinants: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wfn0</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Energy: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ground state wave function: HF
Number of determinants: 1
Energy: -14.572337630953388
</pre></div>
</div>
</div>
</div>
</section>
<section id="full-ci">
<h3>Full CI<a class="headerlink" href="#full-ci" title="Link to this heading">#</a></h3>
<p>Once the integrals are loaded, in the <code class="docutils literal notranslate"><span class="pre">hamiltonian</span></code> object, PyCI offers a simple and flexible framework to implement any CI method following the next steps:</p>
<ol class="arabic simple">
<li><p>Define the wavefunction model (the configurations to be included in the wavefunction).</p></li>
<li><p>Find the representation of the Hamiltonian in the selected configuration space.</p></li>
<li><p>Obtain the desired eigenvalues and eigenvectors of the Hamiltonian.</p></li>
</ol>
<p>The Full CI method gives the exact solution of the electronic Schr√∂dinger equation within a given basis set. It is given by the linear combination of all possible configurations in a given basis set. The following code shows how to define a Full CI wavefunction and compute the energy for the lowest singlet state of the beryllium atom.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wfn1</span> <span class="o">=</span> <span class="n">pyci</span><span class="o">.</span><span class="n">fullci_wfn</span><span class="p">(</span><span class="n">ham</span><span class="o">.</span><span class="n">nbasis</span><span class="p">,</span> <span class="o">*</span><span class="n">occs</span><span class="p">)</span> 
<span class="n">wfn1</span><span class="o">.</span><span class="n">add_all_dets</span><span class="p">()</span>                          <span class="c1"># add all determinants to the wave function</span>

<span class="c1"># Solve the CI matrix problem</span>
<span class="n">op</span> <span class="o">=</span> <span class="n">pyci</span><span class="o">.</span><span class="n">sparse_op</span><span class="p">(</span><span class="n">ham</span><span class="p">,</span> <span class="n">wfn1</span><span class="p">)</span>    

<span class="n">e_vals</span><span class="p">,</span> <span class="n">e_vecs1</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1.0e-9</span><span class="p">)</span>
<span class="n">e_dict</span><span class="p">[</span><span class="s2">&quot;Full-CI&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wfn1</span><span class="p">),</span> <span class="n">e_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ground state wave function: Full CI&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of determinants: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">wfn1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Full CI energy: </span><span class="si">{</span><span class="n">e_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2"> a.u.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ground state wave function: Full CI
Number of determinants: 8281
Full CI energy: -14.61740951 a.u.
</pre></div>
</div>
</div>
</div>
</section>
<section id="cisd">
<h3>CISD<a class="headerlink" href="#cisd" title="Link to this heading">#</a></h3>
<p>The CISD method is a truncated version of the Full CI method that includes all single and double excitations. These calculations can be achieved by truncating the Full CI space to the subset of single and double excitations. The following code shows how to define a CISD wavefunction and compute the energy for the lowest singlet state of the beryllium atom.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a CISD wave function</span>
<span class="n">excitations</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>     <span class="c1"># excitations to include (0 = reference, 1 = single, 2 = double)</span>
<span class="n">wfn2</span> <span class="o">=</span> <span class="n">pyci</span><span class="o">.</span><span class="n">fullci_wfn</span><span class="p">(</span><span class="n">ham</span><span class="o">.</span><span class="n">nbasis</span><span class="p">,</span> <span class="o">*</span><span class="n">occs</span><span class="p">)</span>
<span class="n">pyci</span><span class="o">.</span><span class="n">add_excitations</span><span class="p">(</span><span class="n">wfn2</span><span class="p">,</span> <span class="o">*</span><span class="n">excitations</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="n">op</span> <span class="o">=</span> <span class="n">pyci</span><span class="o">.</span><span class="n">sparse_op</span><span class="p">(</span><span class="n">ham</span><span class="p">,</span> <span class="n">wfn2</span><span class="p">)</span>
<span class="n">e_vals</span><span class="p">,</span> <span class="n">e_vecs2</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1.0e-9</span><span class="p">)</span>
<span class="n">e_dict</span><span class="p">[</span><span class="s2">&quot;CISD&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wfn2</span><span class="p">),</span> <span class="n">e_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ground state wave function: CISD&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of determinants: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">wfn2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CISD energy: </span><span class="si">{</span><span class="n">e_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2"> a.u.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ground state wave function: CISD
Number of determinants: 757
CISD energy: -14.61735579 a.u.
</pre></div>
</div>
</div>
</div>
</section>
<section id="seniority-truncated-ci">
<h3>Seniority-truncated CI<a class="headerlink" href="#seniority-truncated-ci" title="Link to this heading">#</a></h3>
<p>Another way to truncate the Full CI space is by truncating the space according to the seniority quantum number. The seniority quantum number is defined as the number of unpaired electrons in a given configuration. The following code shows how to define a seniority-truncated (0,2) CI wavefunction and compute the energy for the lowest singlet state of the beryllium atom.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Defining a seniority truncated CI wave function</span>
<span class="n">seniorities</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">wfn3</span> <span class="o">=</span> <span class="n">pyci</span><span class="o">.</span><span class="n">fullci_wfn</span><span class="p">(</span><span class="n">ham</span><span class="o">.</span><span class="n">nbasis</span><span class="p">,</span> <span class="o">*</span><span class="n">occs</span><span class="p">)</span>
<span class="n">pyci</span><span class="o">.</span><span class="n">add_seniorities</span><span class="p">(</span><span class="n">wfn3</span><span class="p">,</span> <span class="o">*</span><span class="n">seniorities</span><span class="p">)</span>

<span class="n">op</span> <span class="o">=</span> <span class="n">pyci</span><span class="o">.</span><span class="n">sparse_op</span><span class="p">(</span><span class="n">ham</span><span class="p">,</span> <span class="n">wfn3</span><span class="p">)</span>
<span class="n">e_vals</span><span class="p">,</span> <span class="n">e_vecs3</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1.0e-9</span><span class="p">)</span>
<span class="n">e_dict</span><span class="p">[</span><span class="s2">&quot;SenTrunc-CI&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wfn3</span><span class="p">),</span> <span class="n">e_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ground state wave function: Seniority Truncated CI (0,2)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of determinants: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">wfn3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Seniority Truncated CI energy: </span><span class="si">{</span><span class="n">e_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2"> a.u.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ground state wave function: Seniority Truncated CI (0,2)
Number of determinants: 2275
Seniority Truncated CI energy: -14.61722574 a.u.
</pre></div>
</div>
</div>
</div>
</section>
<section id="griebel-knapeck-ci-gkci">
<h3>Griebel-Knapeck CI (GKCI)<a class="headerlink" href="#griebel-knapeck-ci-gkci" title="Link to this heading">#</a></h3>
<p>The <a class="reference external" href="https://doi.org/10.1016/j.comptc.2018.08.017">Griebel-Knapeck CI</a> method is a CI method which tries to include the determinants such that the CI truncation error is equal to the basis set truncation error. For this, the selection of the determinants to include in the expansion is based on a cost function. The following code shows how to define a GKCI wavefunction and compute the energy for the lowest singlet state of the beryllium atom.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wfn4</span> <span class="o">=</span> <span class="n">pyci</span><span class="o">.</span><span class="n">fullci_wfn</span><span class="p">(</span><span class="n">ham</span><span class="o">.</span><span class="n">nbasis</span><span class="p">,</span> <span class="o">*</span><span class="n">occs</span><span class="p">)</span>
<span class="n">pyci</span><span class="o">.</span><span class="n">add_gkci</span><span class="p">(</span><span class="n">wfn4</span><span class="p">,</span> <span class="n">t</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;cntsp&quot;</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">energies</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="n">op</span> <span class="o">=</span> <span class="n">pyci</span><span class="o">.</span><span class="n">sparse_op</span><span class="p">(</span><span class="n">ham</span><span class="p">,</span> <span class="n">wfn4</span><span class="p">)</span>
<span class="n">e_vals</span><span class="p">,</span> <span class="n">e_vecs4</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1.0e-9</span><span class="p">)</span>
<span class="n">e_dict</span><span class="p">[</span><span class="s2">&quot;GKCI&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wfn4</span><span class="p">),</span> <span class="n">e_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ground state wave function: Generalized Seniority Truncated CI (t=-0.5, p=1.0)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of determinants: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">wfn4</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generalized Seniority Truncated CI energy: </span><span class="si">{</span><span class="n">e_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2"> a.u.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ground state wave function: Generalized Seniority Truncated CI (t=-0.5, p=1.0)
Number of determinants: 169
Generalized Seniority Truncated CI energy: -14.61684259 a.u.
</pre></div>
</div>
</div>
</div>
</section>
<section id="heat-bath-ci">
<h3>Heat Bath CI<a class="headerlink" href="#heat-bath-ci" title="Link to this heading">#</a></h3>
<p>The <a class="reference external" href="https://doi.org/10.1021/acs.jctc.6b00407">Heat Bath CI</a> starts with the Hartree-Fock determinant then use a sampling method to generate determinants connected to the HF determinant with a Hamiltonian matrix element larger than a given threshold. The algorithm is repeated until convergence, each time using the lowest eigenvalue in the selected subspace as the new reference determinant. The following code shows how to define a Heat Bath CI wavefunction and compute the energy for the lowest singlet state of the beryllium atom.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wfn5</span> <span class="o">=</span> <span class="n">pyci</span><span class="o">.</span><span class="n">fullci_wfn</span><span class="p">(</span><span class="n">ham</span><span class="o">.</span><span class="n">nbasis</span><span class="p">,</span> <span class="o">*</span><span class="n">occs</span><span class="p">)</span>

<span class="c1"># Add Hartree-Fock determinant</span>
<span class="n">wfn5</span><span class="o">.</span><span class="n">add_hartreefock_det</span><span class="p">()</span>
<span class="n">dets_added</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Create CI matrix operator and initial Hartree-Fock solution</span>
<span class="n">op</span> <span class="o">=</span> <span class="n">pyci</span><span class="o">.</span><span class="n">sparse_op</span><span class="p">(</span><span class="n">ham</span><span class="p">,</span> <span class="n">wfn5</span><span class="p">)</span>
<span class="n">e_vals</span><span class="p">,</span> <span class="n">e_vecs5</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1.0e-9</span><span class="p">)</span>

<span class="c1"># Run HCI iterations</span>
<span class="n">niter</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">eps</span> <span class="o">=</span> <span class="mf">5.0e-4</span>
<span class="k">while</span> <span class="n">dets_added</span><span class="p">:</span>
    <span class="c1"># Add connected determinants to wave function via HCI</span>
    <span class="n">dets_added</span> <span class="o">=</span> <span class="n">pyci</span><span class="o">.</span><span class="n">add_hci</span><span class="p">(</span><span class="n">ham</span><span class="p">,</span> <span class="n">wfn5</span><span class="p">,</span> <span class="n">e_vecs5</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
    <span class="c1"># Update CI matrix operator</span>
    <span class="n">op</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ham</span><span class="p">,</span> <span class="n">wfn5</span><span class="p">)</span>
    <span class="c1"># Solve CI matrix problem</span>
    <span class="n">e_vals</span><span class="p">,</span> <span class="n">e_vecs5</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1.0e-9</span><span class="p">)</span>
    <span class="n">niter</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">e_dict</span><span class="p">[</span><span class="s2">&quot;HCI&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wfn5</span><span class="p">),</span> <span class="n">e_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ground state wave function: HCI&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of determinants: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">wfn5</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;HCI energy: </span><span class="si">{</span><span class="n">e_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2"> a.u.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of iterations used: </span><span class="si">{</span><span class="n">niter</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ground state wave function: HCI
Number of determinants: 282
HCI energy: -14.61740392 a.u.
Number of iterations used: 4
</pre></div>
</div>
</div>
</div>
<p>The following code shows the performance of all the methods discussed in this tutorial in recovering the correlation energy of the beryllium atom.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">max_corr</span> <span class="o">=</span> <span class="n">e_dict</span><span class="p">[</span><span class="s2">&quot;Full-CI&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">e_dict</span><span class="p">[</span><span class="s2">&quot;HF&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="n">e_ref</span> <span class="o">=</span> <span class="n">e_dict</span><span class="p">[</span><span class="s2">&quot;HF&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Model&#39;</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;# Dets&#39;</span><span class="si">:</span><span class="s2">&gt;10</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Energy [a.u.]&#39;</span><span class="si">:</span><span class="s2">&gt;10</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;E_corr [%]&#39;</span><span class="si">:</span><span class="s2">&gt;10</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">e_dict</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">e_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;10</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">e_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;10.5f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="n">e_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">e_ref</span><span class="p">)</span><span class="o">/</span><span class="n">max_corr</span><span class="si">:</span><span class="s2">&gt;10.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model               # Dets Energy [a.u.] E_corr [%]
HF                       1  -14.57234      -0.00%
Full-CI               8281  -14.61741     100.00%
CISD                   757  -14.61736      99.88%
SenTrunc-CI           2275  -14.61723      99.59%
GKCI                   169  -14.61684      98.74%
HCI                    282  -14.61740      99.99%
</pre></div>
</div>
</div>
</div>
</section>
<section id="overlap">
<h3>Overlap<a class="headerlink" href="#overlap" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">PyCI</span></code> also provides a simple framework to compute the overlap between two wavefunction objects. The following code shows how to compute the overlap between the different wavefunction models discussed in this tutorial.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ovl0</span> <span class="o">=</span> <span class="n">pyci</span><span class="o">.</span><span class="n">compute_overlap</span><span class="p">(</span><span class="n">wfn0</span><span class="p">,</span> <span class="n">wfn1</span><span class="p">,</span> <span class="n">e_vecs0</span><span class="p">,</span> <span class="n">e_vecs1</span><span class="p">)</span>
<span class="n">ovl1</span> <span class="o">=</span> <span class="n">pyci</span><span class="o">.</span><span class="n">compute_overlap</span><span class="p">(</span><span class="n">wfn1</span><span class="p">,</span> <span class="n">wfn1</span><span class="p">,</span> <span class="n">e_vecs1</span><span class="p">,</span> <span class="n">e_vecs1</span><span class="p">)</span>
<span class="n">ovl2</span> <span class="o">=</span> <span class="n">pyci</span><span class="o">.</span><span class="n">compute_overlap</span><span class="p">(</span><span class="n">wfn2</span><span class="p">,</span> <span class="n">wfn1</span><span class="p">,</span> <span class="n">e_vecs2</span><span class="p">,</span> <span class="n">e_vecs1</span><span class="p">)</span>
<span class="n">ovl3</span> <span class="o">=</span> <span class="n">pyci</span><span class="o">.</span><span class="n">compute_overlap</span><span class="p">(</span><span class="n">wfn3</span><span class="p">,</span> <span class="n">wfn1</span><span class="p">,</span> <span class="n">e_vecs3</span><span class="p">,</span> <span class="n">e_vecs1</span><span class="p">)</span>
<span class="n">ovl4</span> <span class="o">=</span> <span class="n">pyci</span><span class="o">.</span><span class="n">compute_overlap</span><span class="p">(</span><span class="n">wfn4</span><span class="p">,</span> <span class="n">wfn1</span><span class="p">,</span> <span class="n">e_vecs4</span><span class="p">,</span> <span class="n">e_vecs1</span><span class="p">)</span>
<span class="n">ovl5</span> <span class="o">=</span> <span class="n">pyci</span><span class="o">.</span><span class="n">compute_overlap</span><span class="p">(</span><span class="n">wfn5</span><span class="p">,</span> <span class="n">wfn1</span><span class="p">,</span> <span class="n">e_vecs5</span><span class="p">,</span> <span class="n">e_vecs1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;HF|FCI&gt;   =  </span><span class="si">{</span><span class="n">ovl0</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;FCI|FCI&gt;  = </span><span class="si">{</span><span class="n">ovl1</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;CISD|FCI&gt; = </span><span class="si">{</span><span class="n">ovl2</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;SCI|FCI&gt;  = </span><span class="si">{</span><span class="n">ovl3</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;GKCI|FCI&gt; = </span><span class="si">{</span><span class="n">ovl4</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;HCI|FCI&gt;  = </span><span class="si">{</span><span class="n">ovl5</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;HF|FCI&gt;   =  0.95238
&lt;FCI|FCI&gt;  = 1.00000
&lt;CISD|FCI&gt; = 1.00000
&lt;SCI|FCI&gt;  = -0.99998
&lt;GKCI|FCI&gt; = 0.99995
&lt;HCI|FCI&gt;  = 1.00000
</pre></div>
</div>
</div>
</div>
</section>
<section id="computing-reduced-density-matrices">
<h3>Computing reduced density matrices<a class="headerlink" href="#computing-reduced-density-matrices" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">PyCI</span></code> also provides a way to compute the reduced density matrices for a given wavefunction object. The following code shows how to compute the one- and two-particle reduced density matrices for the Full CI wavefunction of the beryllium atom.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span> <span class="o">=</span> <span class="n">pyci</span><span class="o">.</span><span class="n">compute_rdms</span><span class="p">(</span><span class="n">wfn5</span><span class="p">,</span> <span class="n">e_vecs5</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">rdm1</span><span class="p">,</span> <span class="n">rdm2</span> <span class="o">=</span> <span class="n">pyci</span><span class="o">.</span><span class="n">spinize_rdms</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RDM1:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape = </span><span class="si">{</span><span class="n">rdm1</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of electrons = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rdm1</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RDM2:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape = </span><span class="si">{</span><span class="n">rdm2</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of electron pairs = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;pqpq&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rdm2</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2.0</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RDM1:
Shape = (28, 28)
Number of electrons = 4.0
RDM2:
Shape = (28, 28, 28, 28)
Number of electron pairs = 6.0
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "QuantumElephant/PyCI",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./examples"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../install.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Installation</p>
      </div>
    </a>
    <a class="right-next"
       href="fanci_tutorial.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">FanCI Quickstart</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#supported-ci-methods">Supported CI methods</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-data-and-defining-the-hamiltonian">Loading data and defining the Hamiltonian</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-reference-hatree-fock-energy">Computing reference (Hatree-Fock) energy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#full-ci">Full CI</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cisd">CISD</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#seniority-truncated-ci">Seniority-truncated CI</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#griebel-knapeck-ci-gkci">Griebel-Knapeck CI (GKCI)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#heat-bath-ci">Heat Bath CI</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overlap">Overlap</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-reduced-density-matrices">Computing reduced density matrices</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The QC-Dev Community with the support of Digital Research Alliance of Canada and The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2023-2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>